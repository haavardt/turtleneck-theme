<!-- /snippets/product-grid-item.liquid -->

{% assign on_sale = false %}
{% if product.compare_at_price > product.price %}
  {% assign on_sale = true %}
{% endif %}

{% assign sold_out = true %}
{% if product.available %}
  {% assign sold_out = false %}
{% endif %}

<div class="product {% if sold_out %} is-sold-out{% endif %}">
    <div class="product-image-wrapper">
      <a class="product-image-link" href="{{ product.url | within: collection }}">
        <img src="{{ product | img_url: 'large' }}" alt="{{ product.featured_image.alt | escape }}" class="product-image">
      </a>
      {% if sold_out %}
        <div class="product-sold-out">
          <p>{{ 'products.product.sold_out_html' | t }}</p>
        </div>
      {% elsif on_sale %}
        <div class="product-on-sale">
          {% capture saved_amount %}{{ product.compare_at_price | minus: product.price | money }}{% endcapture %}
          <p>{{ 'products.general.save_html' | t: saved_amount: saved_amount }}</p>
        </div>
      {% endif %}
    </div>

    <a href="{{ product.url | within: collection }}" class="product-meta" style="background: {{ product.metafields.product.color }}">
      <span class="product-title">{{ product.title }}</span>
      <span class="product-price-wrap">
        <span class="long-dash">â€”</span>
        <span>{{ product.description }}</span>
        <span class="product-price">
          {% if product.price_varies %}
            {{ product.price_min | money_without_trailing_zeros }}
            <span class="icon-fallback-text">
              <span class="icon icon-plus product-price-min" aria-hidden="true"></span>
              <span class="fallback-text">+</span>
            </span>
          {% else %}
            {{ product.price | money_without_trailing_zeros }}
          {% endif %}
        </span>
      </span>
    </a>
</div>
